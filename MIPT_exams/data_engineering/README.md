# Breast Cancer ML Pipeline: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ETL —Å Apache Airflow

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —ç–∫–∑–∞–º–µ–Ω–∞ –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ "–ò–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö". 

–¶–µ–ª—å ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω** –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–ø—É—Ö–æ–ª–µ–π –º–æ–ª–æ—á–Ω–æ–π –∂–µ–ª–µ–∑—ã (–∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ/–¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Apache Airflow** –∏ **Python**.

---

## –¶–µ–ª—å –∏ –∑–∞–¥–∞—á–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å ETL-–ø—Ä–æ—Ü–µ—Å—Å, –≤–∫–ª—é—á–∞—é—â–∏–π:
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (Breast Cancer Wisconsin Diagnostic).
- –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ `LogisticRegression`.
- –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ (Accuracy, Precision, Recall, F1).
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –æ–±–ª–∞–∫–æ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ.
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ —Å –ø–æ–º–æ—â—å—é Apache Airflow.

ML-–∑–∞–¥–∞—á–∞: **–±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** (M = –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è, B = –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è).

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```mermaid
graph TD
    A[–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö<br>load_data.py] --> B[üßπ –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞<br>preprocess.py]
    B --> C[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏<br>train_model.py]
    C --> D[–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏<br>evaluate.py]
    D --> E[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤<br>results/, logs/]
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îî‚îÄ‚îÄ pipeline_dag.py         # DAG-—Ñ–∞–π–ª Airflow
‚îú‚îÄ‚îÄ etl/
‚îÇ   ‚îú‚îÄ‚îÄ load_data.py            # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py           # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ train_model.py          # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ evaluate.py             # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ logger.py               # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—É—Ç–µ–π
‚îú‚îÄ‚îÄ logs/                       # –õ–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
‚îú‚îÄ‚îÄ results/                    # –ú–æ–¥–µ–ª—å –∏ –º–µ—Ç—Ä–∏–∫–∏
‚îú‚îÄ‚îÄ preprocessed/               # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ Makefile                    # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è CLI
‚îú‚îÄ‚îÄ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## –≠—Ç–∞–ø—ã –ø–∞–π–ø–ª–∞–π–Ω–∞

1. **load_data.py**  
   –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç –∏–∑ `sklearn.datasets`, –ø—Ä–æ–≤–æ–¥–∏—Ç –±–∞–∑–æ–≤—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç `.csv`.

2. **preprocess.py**  
   –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ: –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (`StandardScaler`), –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

3. **train_model.py**  
   –û–±—É—á–∞–µ—Ç `LogisticRegression` –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–æ–¥–µ–ª—å (`.pkl`).

4. **evaluate.py**  
   –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (`.json`).

---

## –ó–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞

### –ß–µ—Ä–µ–∑ `make`:

```bash
make all        # –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫
make download   # –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞
make clean      # –û—á–∏—Å—Ç–∫–∞
```

### –ß–µ—Ä–µ–∑ Airflow (bash):

```bash
airflow dags list
airflow dags trigger breast_cancer_ml_pipeline
airflow tasks test download_data 2025-06-14
```

DAG ID: `breast_cancer_ml_pipeline`

---

## –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π

–ü—Ä–æ–µ–∫—Ç —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏:

- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –∫–∞–∂–¥—ã–π —à–∞–≥ –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π Python-—Å–∫—Ä–∏–ø—Ç (`load_data.py`, `preprocess.py`, `train_model.py`, `evaluate.py`), —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É.
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `config.py`**: —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—É—Ç–µ–π –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–≤—ã—à–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞.
- **–õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –ª–æ–≥, —Ñ–∏–∫—Å–∏—Ä—É—é—â–∏–π —É—Å–ø–µ—à–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ –æ—à–∏–±–∫–∏ ‚Äî —ç—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –∏ —É–ø—Ä–æ—â–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É.
- **Airflow –∫–∞–∫ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä**: DAG –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –∑–∞–ø—É—Å–∫–∞ —à–∞–≥–æ–≤, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ —Å–±–æ–µ, –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.
- **BashOperator**: –≤—ã–±–æ—Ä BashOperator —É–ø—Ä–æ—â–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é, –ø–æ–∑–≤–æ–ª—è—è –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –±–µ–∑ –æ–±–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –≤ PythonOperator.
- **–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**: –º–æ–¥–µ–ª—å –∏ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results/` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–æ–∑–º–æ–∂–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏.

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –ª—ë–≥–∫–æ—Å—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏.

---

## –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã (–º–æ–¥–µ–ª—å –∏ –º–µ—Ç—Ä–∏–∫–∏) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è **–ª–æ–∫–∞–ª—å–Ω–æ**:

```
results/
‚îú‚îÄ‚îÄ model.pkl         # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îî‚îÄ‚îÄ metrics.json      # Accuracy, F1, Precision, Recall
```

–ú–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥:
- Google Drive API
- Dropbox API
- Amazon S3 (`boto3` + `.env`)

---

## –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

–ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å:
- –∏–º–µ–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`logs/*.log`);
- —Å–æ–¥–µ—Ä–∂–∏—Ç `try/except` —Å `logger.exception(...)`;
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.

Airflow:
- –≤–∫–ª—é—á–∞–µ—Ç `retries`, `execution_timeout`, `on_failure_callback`;
- –∏–∑–æ–ª–∏—Ä—É–µ—Ç —à–∞–≥–∏ (–æ—à–∏–±–∫–∞ –≤ –æ–¥–Ω–æ–º ‚Äî –Ω–µ —Ä—É—à–∏—Ç –≤–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω);
- –≤—Å–µ —à–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ `BashOperator` –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.

---

## –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø–∞–π–ø–ª–∞–π–Ω–∞

–ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –æ–±–µ—Ä–Ω—É—Ç –≤ `try-except`, –ª–æ–≥–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ `.log` —Ñ–∞–π–ª—ã. DAG –≤–∫–ª—é—á–∞–µ—Ç:

- `retries=2` ‚Äî –ø–æ–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏ –≤ —Å–ª—É—á–∞–µ —Å–±–æ—è;
- `execution_timeout=20 –º–∏–Ω—É—Ç` ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è;
- `on_failure_callback` ‚Äî –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–¥ Slack/Telegram).

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞:

| –≠—Ç–∞–ø           | –í–æ–∑–º–æ–∂–Ω–∞—è –æ—à–∏–±–∫–∞                  | –†–µ–∞–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã                            |
|----------------|-----------------------------------|--------------------------------------------|
| –ó–∞–≥—Ä—É–∑–∫–∞       | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `target`, NaN          | –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –∏—Å–∫–ª—é—á–µ–Ω–∏–µ                  |
| –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞  | –û—à–∏–±–∫–∏ –º–∞–ø–ø–∏–Ω–≥–∞, –ø—Ä–æ–ø—É—Å–∫–∏         | –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞           |
| –û–±—É—á–µ–Ω–∏–µ       | –û—à–∏–±–∫–∞ –º–æ–¥–µ–ª–∏, shape mismatch     | –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ                  |
| –û—Ü–µ–Ω–∫–∞         | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `model.pkl`          | –ò—Å–∫–ª—é—á–µ–Ω–∏–µ, –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ                   |

---

## –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞


- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –º–æ–¥–µ–ª–∏ –ø–æ –¥–∞—Ç–µ (`model_2025-06-14.pkl`);
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `MLflow` –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞;
- –î–æ–±–∞–≤–∏—Ç—å `Great Expectations` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö;
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram-–±–æ—Ç–æ–º –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

---

## –°–∫—Ä–∏–Ω—à–æ—Ç —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ DAG

![alt text](image.png)

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:

```bash
pip install -r requirements.txt
```

–î–ª—è –∑–∞–ø—É—Å–∫–∞ Airflow:

```bash
export AIRFLOW_HOME=~/airflow
airflow db init
airflow users create --username admin --password admin --firstname admin --lastname user --role Admin --email admin@example.com
airflow webserver --port 8080
airflow scheduler
```

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [http://localhost:8080](http://localhost:8080) –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ DAG.


–°–º. `requirements.txt`

---
